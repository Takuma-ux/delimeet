# Flutter UI デバッグ・ファイル構造問題解決ガイド

## 問題の概要
Flutter アプリで「1回目のログインは正常表示、2回目以降は異なる表示」という問題が発生。

## 根本原因の特定方法

### 1. ログ分析による問題特定
```
flutter: 🔥 SearchPage: build開始 - 現在時刻 = 1749786270492
```
- ログから実際に実行されているコードの場所を特定
- 期待するファイルと実際に実行されているファイルが異なることを発見

### 2. ファイル構造の確認手順
```bash
# セマンティック検索でクラス定義を確認
codebase_search "SearchPage class definition"
```

**重要な発見**: 
- `dating_food_app/lib/screens/search_page.dart` に正しいUIが実装済み
- しかし実際には `dating_food_app/lib/main.dart` 内の `SearchPage` クラスが使用されていた

### 3. 実行ファイルの特定方法
- ログの出力場所を追跡
- `main.dart` 内に古いUIロジックが残存していることを確認
- アプリが `main.dart` の `SearchPage` を優先的に使用

## 解決アプローチ

### 1. 正しいファイルの特定
- ログ出力から実際に実行されているコードを特定
- 複数の同名クラスが存在する場合、どれが使用されているかを確認

### 2. UI統一化の実装
```dart
// 統一されたカードサイズ
Container(
  width: 140,  // 統一された幅
  height: 200, // 統一された高さ
  // ...
)

// 画像部分の固定サイズ
Container(
  width: 140,
  height: 120, // 固定高さ
  // ...
)

// テキスト部分の固定サイズ
Container(
  width: 140,
  height: 80, // 固定高さ
  // ...
)
```

### 3. メインボタンの追加
```dart
// 常に表示されるメインボタン
Row(
  children: [
    Expanded(child: _buildMainButton(...)),
    const SizedBox(width: 16),
    Expanded(child: _buildMainButton(...)),
  ],
)
```

### 4. テキストサイズの調整
```dart
// 統一されたテキストスタイル
Text(
  name,
  style: const TextStyle(
    fontWeight: FontWeight.bold,
    fontSize: 14, // 16px → 14px
  ),
)

Text(
  details,
  style: const TextStyle(
    fontSize: 12, // 14px → 12px
    color: Colors.grey,
  ),
)
```

## 重要な学習ポイント

### 1. ファイル構造の重要性
- 同名クラスが複数存在する場合、どれが実際に使用されているかを必ず確認
- `main.dart` 内のクラスが優先される場合が多い

### 2. ログ分析の重要性
- UI表示の問題はログから実行場所を特定することが最も効率的
- 期待する動作と実際の動作の差分をログで確認

### 3. UI統一化のベストプラクティス
- カードサイズは固定値で統一
- 画像とテキスト部分の高さを明確に分離
- フォントサイズは階層的に設定（見出し14px、詳細12px）

### 4. デバッグ手順
1. ログで実行場所を特定
2. セマンティック検索で関連ファイルを確認
3. 実際に使用されているファイルを特定
4. 正しいファイルに修正を適用

## 今後の予防策

### 1. ファイル命名規則
- 同名クラスを避ける
- 機能別にディレクトリを分離

### 2. インポート管理
- 使用するクラスのインポート元を明確化
- 不要なファイルの削除

### 3. ログ出力の活用
- 重要な処理にはログ出力を追加
- ファイル名・行番号を含むログ出力

## 修正結果
- ✅ 1回目・2回目のログイン表示が統一
- ✅ メインボタンが常に表示
- ✅ カードサイズが統一（140×200px）
- ✅ テキストサイズが適切に調整
- ✅ 画像表示の問題解決 